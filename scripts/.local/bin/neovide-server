#!/bin/bash

NVIM_SERVER_SOCKET="${XDG_RUNTIME_DIR:-/tmp}/nvim-neovide-server"

is_socket_alive() {
        nvr --servername "$NVIM_SERVER_SOCKET" --remote-expr "1" >/dev/null 2>&1
}

if [ -S "$NVIM_SERVER_SOCKET" ] && is_socket_alive; then
        nvr --servername "$NVIM_SERVER_SOCKET" --remote "$@"
else
        rm -f "$NVIM_SERVER_SOCKET"
        neovide --grid 100x100 -- --listen "$NVIM_SERVER_SOCKET" "$@"
fi
