#!/bin/sh

command -v yay >/dev/null 2>&1 || {
        echo "'yay' executable not found."
        exit 1
}

yay -Syu || {
        echo "Some packages couldn't be updated!"
}

while true; do
        printf "Do you wish to restow the dotfiles? (y/n) "
        IFS= read -r yn

        case $yn in
                [Yy]* ) 
                        command -v stow >/dev/null 2>&1 || {
                                echo "'stow' executable not found."
                                exit 1
                        }

                        cd "$HOME/.dotfiles" || {
                                echo "Can't find the ~/.dotfiles folder."
                                exit 1 
                        }
                        
                        for pkg in */; do
                                stow --restow --verbose 1 $pkg
                        done

                        break;;
                [Nn]* ) exit;;
                * ) echo "Please answer yes or no.";;
        esac
done
